---
title: ruoyi
date: 2022-02-12 10:19:53
categories:
- web
tags:
- web
- spring boot
- vue
---

# 若依
## 环境
1. jdk 1.8+
2. mysql
3. redis
4. maven
5. vue

## 使用
1. 下载并运行
2. 看懂业务流程
3. 二次开发

## 登录
### 生成验证码
基本思路：
1. 后端生成一个表达式：`1+1=?@2`
2. 将 `1+1=?` 转成图片，传到前端展示
3. 将 `2` 存入redis（放在captcha_codes文件夹中）
### 登录
1. 前端
   1. 上传登录表单
2. 后端
   1. 校验验证码
   2. 校验用户名和密码
   3. 生成token
3. 前端
   1. 存储token

  
### getInfo & generateRouters
前端设置了全局路由，在每次路由跳转时都会调用getInfo和getRouters。  
getInfo用来获取用户的角色和权限信息。  
前端拿到角色和权限以后存储到vuex中。  
获取到角色和权限以后生成前端路由。  

## 异步任务管理器
后端使用异步任务管理器，结合线程池，实现了异步的操作日志记录，和业务逻辑实现异步解耦。  
1. AsyncManager.me() 获取一个 AsycnManager 对象
2. 执行execute方法，执行任务，传入的是一个Task对象，实现了Runnable接口，是一个任务，由线程去执行

异步任务管理器，内部定义了一个线程池，内部定义了一个线程池，然后根据业务创建添加日志的任务，交给线程池来处理。这样做到日志和业务的抽象，解耦合，日志全部统一处理。

## 代码自动生成
1. 创建数据表
2. 系统工具->代码生成 -> 导入数据库表
3. 编辑信息
4. 点击生成代码
5. 下载代码
6. 解压 （main、vue、sql）
7. 导入代码，重启项目